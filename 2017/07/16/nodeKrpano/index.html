<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="NingBo"><meta name="description" conauthortent="宁勃的博客"><link rel="alternative" href="/atom.xml" title="I am NingBo" type="application/atom+xml"><link rel="icon" href="/favicon.png"><title>krpano全景笔记 - I am NingBo</title><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/js/fancybox/jquery.fancybox.min.css"><!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]--><script src="/js/jquery-3.1.1.min.js"></script><script src="/js/fancybox/jquery.fancybox.min.js"></script></head><body style="opacity:0;"><header class="head"><h1 class="head-title u-fl"><a href="/">I am NingBo</a></h1><nav class="head-nav u-fr"><ul class="head-nav__list"><li class="head-nav__item"><a class="head-nav__link" href="/archives">カタログ/（目录）</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__head"> <time class="post__time" datetime="2017-07-16T01:31:04.000Z">七月 16, 2017</time><h1 class="post__title"><a href="/2017/07/16/nodeKrpano/">krpano全景笔记</a></h1><div class="post__main echo"><h1 id="krpano"><a href="#krpano" class="headerlink" title="krpano"></a>krpano</h1><p>Krpano 可以方便快速的构建全景场景或全景视频(<a href="http://test.go.163.com/go/2015/public/team/ningbo/krpano/comn01/" target="_blank" rel="external">demo</a>)</p>
<h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><ul>
<li><a href="#krpano-droplet">Krpano Droplet</a><ul>
<li><a href="#make-pano-normal">MAKE PANO (NORMAL)</a></li>
<li><a href="#make-pano-multires">MAKE PANO (MULTIRES)</a></li>
<li><a href="#make-pano-singleswf">MAKE PANO (SINGLESWF)</a></li>
<li><a href="#make-pano-flat">MAKE PANO (FLAT)</a></li>
<li><a href="#make-vtour-normal">MAKE VTOUR (NORMAL)</a></li>
<li><a href="#make-vtour-multires">MAKE VTOUR (MULTIRES)</a></li>
<li><a href="#make-object">MAKE OBJECT</a></li>
<li><a href="#convert-sphere-to-cube">Convert SPHERE to CUBE</a></li>
<li><a href="#convert-cube-to-sphere">Convert CUBE to SPHERE</a></li>
<li><a href="#encrypt-xml">Encrypt XML</a></li>
</ul>
</li>
<li><a href="#vtour-文件夹说明">vtour 文件夹说明</a><ul>
<li><a href="#vtour-文件夹结构">vtour 文件夹结构</a></li>
<li><a href="#vtour-运作机制">vtour 运作机制</a></li>
</ul>
</li>
<li><a href="#krpano-xml结构">krpano XML结构</a><ul>
<li><a href="#krpano-内置元素说明">Krpano 内置元素说明</a></li>
</ul>
</li>
<li><a href="#常用设置">常用设置</a><ul>
<li><a href="#小行星开场">小行星开场</a></li>
<li><a href="#加载动画">加载动画</a></li>
<li><a href="#修改右键菜单">修改右键菜单</a></li>
<li><a href="#自定义热点">自定义热点</a></li>
<li><a href="#隐藏皮肤">隐藏皮肤</a></li>
<li><a href="#动态热点">添加动态热点</a></li>
<li><a href="#动态热点添加始终显示的文字">动态热点添加始终显示的文字</a></li>
<li><a href="#热点和或图层在鼠标点击或鼠标悬停时进入动态模式">热点和或图层在鼠标点击或鼠标悬停时进入动态模式</a></li>
<li><a href="#拖拽热点">拖拽热点</a></li>
<li><a href="#添加简单的全景视频">添加简单的全景视频</a></li>
<li><a href="#添加雨雪特效">添加雨雪特效</a></li>
<li><a href="#自动旋转">自动旋转</a></li>
<li><a href="#无按钮控制的自动旋转">无按钮控制的自动旋转</a></li>
<li><a href="#按钮控制的自动旋转">按钮控制的自动旋转</a></li>
<li><a href="#添加陀螺仪">添加陀螺仪</a></li>
<li><a href="#场景过渡效果">场景过渡效果</a></li>
<li><a href="#隐藏显示热点">隐藏显示热点</a></li>
<li><a href="#获取全景视频进度">获取全景视频进度</a></li>
</ul>
</li>
</ul>
<hr>
<p>原文链接：<br><a href="https://krpano.milly.me/" target="_blank" rel="external">https://krpano.milly.me/</a><br><a href="http://www.krpano360.com/" target="_blank" rel="external">http://www.krpano360.com/</a></p>
<p>GitHub: <a href="https://github.com/NalvyBoo/nodeKrpano/" target="_blank" rel="external">nodeKrpano</a></p>
<h2 id="Krpano-Droplet"><a href="#Krpano-Droplet" class="headerlink" title="Krpano Droplet"></a>Krpano Droplet</h2><h3 id="MAKE-PANO-NORMAL"><a href="#MAKE-PANO-NORMAL" class="headerlink" title="MAKE PANO (NORMAL)"></a>MAKE PANO (NORMAL)</h3><p><strong>用法说明</strong></p>
<ul>
<li>生成普通 (=单分辨率) 全景</li>
<li>制作典型的 360 度全景</li>
<li>全部全景图将会一次性载入. 默认下方块最大变长为 2048 像素(可以在配置文件中修改)</li>
<li>包括默认的导航皮肤</li>
<li>支持 <code>Flash</code> 和 <code>HTML5</code></li>
</ul>
<p><strong>Droplet 说明</strong></p>
<ul>
<li>配置文件: <code>normal.config</code></li>
<li>默认模版/皮肤配置文件: <code>defaultbuttons.skin</code></li>
</ul>
<hr>
<h3 id="MAKE-PANO-MULTIRES"><a href="#MAKE-PANO-MULTIRES" class="headerlink" title="MAKE PANO (MULTIRES)"></a>MAKE PANO (MULTIRES)</h3><p><strong>用法说明</strong></p>
<ul>
<li>生成多分辨率全景</li>
<li>制作所有类型的全景</li>
<li>只有特定的切片在需要时载入 没有尺寸/分辨率限制</li>
<li>包含默认的导航皮肤</li>
<li>支持 <code>Flash</code> 和 <code>HTML5</code></li>
</ul>
<p><strong>Droplet 说明</strong></p>
<p>配置文件: <code>multiresconfig</code><br>默认模版/皮肤配置文件: <code>defaultbuttonsskin</code></p>
<hr>
<h3 id="MAKE-PANO-SINGLESWF"><a href="#MAKE-PANO-SINGLESWF" class="headerlink" title="MAKE PANO (SINGLESWF)"></a>MAKE PANO (SINGLESWF)</h3><p><strong>用法说明</strong></p>
<ul>
<li>生成普通 (=单分辨率) 全景同时将所有文件嵌在一个SWF文件中只输出一个SWF文件和一个HTML文件</li>
<li>制作典型的360度全景</li>
<li>全部全景图将会一次性载入 默认下方块最大变长为2048像素(可以在配置文件中修改)</li>
<li>包含默认的导航皮肤</li>
<li>仅支持 <code>Flash</code></li>
</ul>
<p><strong>Droplet 说明</strong></p>
<p>配置文件: <code>singleswfconfig</code><br>默认模版/皮肤配置文件: <code>defaultbuttonsskin</code></p>
<hr>
<h3 id="MAKE-PANO-FLAT"><a href="#MAKE-PANO-FLAT" class="headerlink" title="MAKE PANO (FLAT)"></a>MAKE PANO (FLAT)</h3><p><strong>用法说明</strong></p>
<ul>
<li>生成平面切片多分辨率图像</li>
<li>制作平面图像 输出时既定为平面图像</li>
<li>只有特定的切片在需要时载入 没有尺寸/分辨率限制</li>
<li>包含有默认导航按钮的皮肤，针对特定的视角</li>
<li>支持 <code>Flash</code> 与 <code>HTML5</code></li>
</ul>
<p><strong>Droplet 说明</strong></p>
<ul>
<li>配置文件: <code>flatconfig</code></li>
<li>默认模版/皮肤配置文件: <code>flatxml / flatskinxml</code></li>
</ul>
<hr>
<h3 id="MAKE-VTOUR-NORMAL"><a href="#MAKE-VTOUR-NORMAL" class="headerlink" title="MAKE VTOUR (NORMAL)"></a>MAKE VTOUR (NORMAL)</h3><p><strong>用法说明</strong></p>
<ul>
<li>生成普通 (=单分辨率) 全景并将它们整合到一个虚拟漫游中</li>
<li>制作典型的 360 度全景</li>
<li>全部全景图将会一次性载入 默认下方块最大变长为 2048 像素(可以在配置文件中修改)</li>
<li>包含一个包括导航按钮、可滚动缩略图以及可选择必应地图以及重力感应插件的默认皮肤</li>
<li>支持 <code>Flash</code> 和 <code>HTML5</code></li>
</ul>
<p><strong>Droplet 说明</strong></p>
<ul>
<li>配置文件: <code>vtour-normalconfig</code></li>
<li>默认模版/皮肤配置文件: <code>vtourskin-thumbnails-bingmaps-gyroskin</code></li>
</ul>
<hr>
<h3 id="MAKE-VTOUR-MULTIRES"><a href="#MAKE-VTOUR-MULTIRES" class="headerlink" title="MAKE VTOUR (MULTIRES)"></a>MAKE VTOUR (MULTIRES)</h3><p><strong>用法说明</strong></p>
<ul>
<li>生成多分辨率全景并将它们整合到一个虚拟漫游中</li>
<li>制作所有类型全景图像</li>
<li>只有特定的切片在需要时载入 没有尺寸/分辨率限制</li>
<li>包含一个包括导航按钮、可滚动缩略图以及可选择必应地图以及重力感应插件的默认皮肤</li>
<li>支持 <code>Flash</code> 和 <code>HTML5</code></li>
</ul>
<p><strong>Droplet 说明</strong></p>
<ul>
<li>配置文件: <code>vtour-multiresconfig</code></li>
<li>默认模版/皮肤配置文件: <code>vtourskin-thumbnails-bingmaps-gyroskin</code></li>
</ul>
<hr>
<h3 id="MAKE-OBJECT"><a href="#MAKE-OBJECT" class="headerlink" title="MAKE OBJECT"></a>MAKE OBJECT</h3><p><strong>用法说明</strong></p>
<ul>
<li>生成若干个平面多分辨率图像并将它们整合到一个可缩放旋转的 360 物体影像中</li>
<li>制作平面图像物体 所有物体图片的尺寸必须一致</li>
<li>只有特定的切片在需要时载入 没有尺寸/分辨率限制</li>
<li>包含一个特定的控制物体的皮肤</li>
<li>仅支持 <code>Flash</code></li>
</ul>
<p><strong>Droplet 说明</strong></p>
<ul>
<li>配置文件: <code>objectconfig</code></li>
<li>默认模版/皮肤配置文件: <code>objectxml / objectskinxml</code></li>
</ul>
<hr>
<h3 id="Convert-SPHERE-to-CUBE"><a href="#Convert-SPHERE-to-CUBE" class="headerlink" title="Convert SPHERE to CUBE"></a>Convert SPHERE to CUBE</h3><p><strong>用法说明</strong></p>
<ul>
<li>将球面图像转换至立方体图</li>
<li>输出的立方体格式、尺寸以及图像尺寸可以在配置文件中修改</li>
</ul>
<p><strong>Droplet 说明</strong></p>
<ul>
<li>配置文件: <code>convertdropletsconfig</code></li>
</ul>
<hr>
<h3 id="Convert-CUBE-to-SPHERE"><a href="#Convert-CUBE-to-SPHERE" class="headerlink" title="Convert CUBE to SPHERE"></a>Convert CUBE to SPHERE</h3><p><strong>用法说明</strong></p>
<ul>
<li>将六张立方体图像转换成一张球面全景图</li>
<li>输出的图像尺寸和格式可以在配置文件中修改</li>
</ul>
<p><strong>Droplet 说明</strong></p>
<ul>
<li>配置文件: <code>convertdropletsconfig</code></li>
</ul>
<hr>
<h3 id="Encrypt-XML"><a href="#Encrypt-XML" class="headerlink" title="Encrypt XML"></a>Encrypt XML</h3><p><strong>用法说明</strong></p>
<ul>
<li>将 <code>xml</code> 文件拖放进 <code>droplet</code> 进行加密</li>
<li>加密过程中 <code>xml</code> 文件会自动被压缩</li>
</ul>
<hr>
<h3 id="自定义-droplet"><a href="#自定义-droplet" class="headerlink" title="自定义 droplet"></a>自定义 droplet</h3><p>如果内置 <code>droplet</code> 不能满足需求或者需要对一些参数进行自定义。只要复制并重命名一个配置文件与皮肤配置文件，然后复制并重命名一个 <code>droplet</code>，修改里面的配置路径即可。</p>
<hr>
<h2 id="vtour-文件夹说明"><a href="#vtour-文件夹说明" class="headerlink" title="vtour 文件夹说明"></a>vtour 文件夹说明</h2><h3 id="vtour-文件夹结构"><a href="#vtour-文件夹结构" class="headerlink" title="vtour 文件夹结构"></a>vtour 文件夹结构</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">vtour/</div><div class="line">| -- panos/             #存放全景切片图片的文件夹</div><div class="line">| -- skin/              #存放皮肤相关文件</div><div class="line">| -- plugins/           #用来存放插件</div><div class="line">| -- tour.swf           #krpano flash viewer</div><div class="line">| -- tour.js            #krpano HTML5 viewer</div><div class="line">| -- tour.xml           #生成全景的相关配置</div><div class="line">| -- tour.html          #用来浏览全景的页面，需要本地服务环境</div><div class="line">| -- tour_editor.html   #添加热点（hotspot）与初始化视角的设置</div></pre></td></tr></table></figure>
<h3 id="vtour-运作机制"><a href="#vtour-运作机制" class="headerlink" title="vtour 运作机制"></a>vtour 运作机制</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"pano"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"tour.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">embedpano(&#123;</div><div class="line">    <span class="attr">swf</span>: <span class="string">"tour.swf"</span>, <span class="comment">//有则表示加载flash引擎，如果设置html5:only则不需要该值</span></div><div class="line">    xml: <span class="string">"tour.xml"</span>, <span class="comment">//启动时的配置文件</span></div><div class="line">    target: <span class="string">"pano"</span>, <span class="comment">//要渲染到的目标容器ID</span></div><div class="line">    html5: <span class="string">"only"</span>, <span class="comment">//如果有需要用到flash，可设置为auto</span></div><div class="line">    <span class="comment">//id: "krpanoSWFObject", //默认的krpano对象，每一个viewer对应唯一id，与JS交互时要用到</span></div><div class="line">    mobilescale: <span class="number">1.0</span>, <span class="comment">//移动设备缩放，1表示不缩放，默认0.5</span></div><div class="line">    passQueryParameters: <span class="literal">false</span> <span class="comment">//是否接受URL传参，例如：tour.html?html5=only&amp;startscene=scene2</span></div><div class="line">&#125;);</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="krpano-XML结构"><a href="#krpano-XML结构" class="headerlink" title="krpano XML结构"></a>krpano XML结构</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">krpano</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">include</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">preview</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">image</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">view</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">area</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">display</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">control</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">cursors</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">autorotate</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">layer</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">hotspot</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="xml"></span></div><div class="line">    <span class="tag">&lt;<span class="name">events</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">contextmenu</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">network</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">memory</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">security</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">textstyle</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">lensflareset</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">lensflare</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">data</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">scene</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">krpano</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="Krpano-内置元素说明"><a href="#Krpano-内置元素说明" class="headerlink" title="Krpano 内置元素说明"></a>Krpano 内置元素说明</h3><p><strong>01.krpano</strong></p>
<p><code>krpano</code> 元素是 <code>krpano xml</code> 文件的根元素。任何一个 <code>krpano xml</code> 文件内的其它元素都要被 <code>krpano</code> 元素所嵌套。</p>
<p><strong>02.include</strong></p>
<p><code>include</code> 元素可引入其它 <code>xml</code> 文件的内容，例如我们常要用到的 <code>vtourskin.xml</code> 就是使用 <code>include</code> 嵌入到主 <code>xml</code> 中。</p>
<p><strong>03.preview</strong></p>
<p>预览图设置，也就是全景图完全载入之前的模糊图像，但因为体积较小，因此载入速度较快，会在全景图之前先载入，避免黑屏。</p>
<p><strong>04.image</strong></p>
<p>image 元素控制全景图设置，包括全景图类型，渐进分辨率切片显示等。</p>
<p><strong>05.view</strong></p>
<p>view 元素控制全景的视野，例如起始视角、视角限制与缩放等等。当要设置限制视角或设定特定的初始视角时，需要自行设定或使用插件获取代码。</p>
<p><strong>06.area</strong></p>
<p>area 元素控制全景图在浏览器窗口中显示区域大小。</p>
<p><strong>07.display</strong></p>
<p>控制全景图的显示品质。</p>
<p><strong>08.control</strong></p>
<p>设置鼠标、键盘以及触摸设备对全景浏览的控制方式。</p>
<p><strong>09.cursors</strong></p>
<p>设置鼠标光标样式。</p>
<p><strong>10.autorotate</strong></p>
<p>控制自动旋转。</p>
<p><strong>11.plugin</strong></p>
<p>用来调用插件、插入图片或生成容器。</p>
<p><strong>12.layer</strong></p>
<p>与 <code>plugin</code> 作用相同，只是名称不同。</p>
<p><strong>13.hotspot</strong></p>
<p>热点，可在 3D 空间中插入图片，使之随着 3D 空间一同运动，可制作很多特效。</p>
<p><strong>14.style</strong></p>
<p>可以保存其它元素的属性子集。</p>
<p><strong>15.events</strong></p>
<p>可调用各类型事件，例如全景载入的不同阶段以及鼠标触发的不同行为等。</p>
<p><strong>16.action</strong></p>
<p>自定义动态代码。</p>
<p><strong>17.contextmenu</strong></p>
<p>定义右键菜单的内容。</p>
<p><strong>18.network</strong></p>
<p>控制图像的下载、缓存与解码。</p>
<p><strong>19.menory</strong></p>
<p>控制全景图在设备中的存储。</p>
<p><strong>20.security</strong></p>
<p><code>Flashplayer</code> 和 <code>HTML5</code> 相关的安全/跨域设置。</p>
<p><strong>21.lensflareset</strong></p>
<p>镜头眩光的设置（目前只能在 <code>flash</code> 下使用）。</p>
<p><strong>22.lensflare</strong></p>
<p>生成镜头眩光（目前只能在 <code>flash</code> 下使用）。</p>
<p><strong>23.data</strong></p>
<p>可放置任意的数据。</p>
<p><strong>24.scene</strong></p>
<p>可放置任意 <code>krpano</code> 元素。每个 <code>scene</code> 元素只有在被 <code>loadscene</code> 时才会被载入到浏览器进行解析。</p>
<h2 id="常用设置"><a href="#常用设置" class="headerlink" title="常用设置"></a>常用设置</h2><h3 id="小行星开场"><a href="#小行星开场" class="headerlink" title="小行星开场"></a>小行星开场</h3><p>开启小行星，先找到 <code>tour.xml</code> ，然后搜索 <code>littleplanetintro</code> 将其值设置为 <code>true</code> 即可。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">skin_settings</span></span></div><div class="line">    <span class="attr">...</span></div><div class="line">    <span class="attr">littleplanetintro</span>=<span class="string">"true"</span></div><div class="line">    <span class="attr">...</span></div><div class="line">/&gt;</div></pre></td></tr></table></figure>
<h3 id="加载动画"><a href="#加载动画" class="headerlink" title="加载动画"></a>加载动画</h3><p>在官方的案例文件夹中找到 <code>loading-progress</code> 这个文件夹，将需要的文件内容复制到项目中的 <code>skin</code> 文件夹，然后在 <code>tour.xml</code> 文件中引入该文件即可，这样重新打开就可以看到有动态的进度条了。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">include</span> <span class="attr">url</span>=<span class="string">"skin/loadingbar.xml"</span> /&gt;</span></div></pre></td></tr></table></figure>
<h3 id="修改右键菜单"><a href="#修改右键菜单" class="headerlink" title="修改右键菜单"></a>修改右键菜单</h3><p>找到引入的皮肤文件，默认在 <code>vtourskin.xml</code> ，然后修改下面这些地方即可自定义右键菜单，但像版权、全屏菜单即使删除也会存在。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">contextmenu</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"fv"</span> <span class="attr">caption</span>=<span class="string">"鱼眼视图"</span> <span class="attr">onclick</span>=<span class="string">"skin_view_fisheye();"</span> <span class="attr">showif</span>=<span class="string">"view.vlookatrange == 180"</span> <span class="attr">devices</span>=<span class="string">"flash|webgl"</span> <span class="attr">separator</span>=<span class="string">"true"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">contextmenu</span>&gt;</span></div></pre></td></tr></table></figure>
<p><strong>contextmenu元素</strong></p>
<ul>
<li><code>caption</code> 右键菜单显示的文字</li>
<li><code>onclick</code> 控制点击后执行的动作，动作由 <code>action</code> 定义</li>
<li><code>showif</code> 显示条目的条件</li>
<li><code>devices</code> 控制在 <code>flash/webgl</code> 哪个模式中出现</li>
<li><code>separator</code> 显示分隔符来分隔菜单</li>
</ul>
<h3 id="自定义热点"><a href="#自定义热点" class="headerlink" title="自定义热点"></a>自定义热点</h3><p>配置 <code>&lt;hotspot&gt;</code> 中 <code>style</code> 的属性对应的元素（<code>skin</code>对应的文件夹）</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">hotspot</span> <span class="attr">name</span>=<span class="string">"spot1"</span> <span class="attr">style</span>=<span class="string">"skin_hotspotstyle"</span> <span class="attr">ath</span>=<span class="string">"93.531"</span> <span class="attr">atv</span>=<span class="string">"-1.109"</span> <span class="attr">linkedscene</span>=<span class="string">"scene_shuilifang"</span> /&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- skin_hotspotstyle - style for the hotspots --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"skin_hotspotstyle"</span> <span class="attr">url</span>=<span class="string">"vtourskin_hotspot.png"</span> <span class="attr">scale</span>=<span class="string">"0.5"</span> <span class="attr">edge</span>=<span class="string">"top"</span> <span class="attr">distorted</span>=<span class="string">"true"</span></span></div><div class="line">	       <span class="attr">tooltip</span>=<span class="string">""</span></div><div class="line">	       <span class="attr">linkedscene</span>=<span class="string">""</span></div><div class="line">	       <span class="attr">linkedscene_lookat</span>=<span class="string">""</span></div><div class="line">	       <span class="attr">onclick</span>=<span class="string">"skin_hotspotstyle_click();"</span></div><div class="line">	       <span class="attr">onover</span>=<span class="string">"tween(scale,0.55);"</span></div><div class="line">	       <span class="attr">onout</span>=<span class="string">"tween(scale,0.5);"</span></div><div class="line">	       <span class="attr">onloaded</span>=<span class="string">"if(linkedscene AND skin_settings.tooltips_hotspots, copy(tooltip,scene[get(linkedscene)].title); loadstyle(skin_tooltips); );"</span></div><div class="line">	       /&gt;<span class="undefined"></span></div></pre></td></tr></table></figure>
<h3 id="隐藏皮肤"><a href="#隐藏皮肤" class="headerlink" title="隐藏皮肤"></a>隐藏皮肤</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"startup"</span> <span class="attr">autorun</span>=<span class="string">"onstart"</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!--添加代码 隐藏皮肤 --&gt;</span></div><div class="line">	set(events[skin_events].name, null);</div><div class="line">  	for(set(i,0), i LT layer.count, inc(i), </div><div class="line">	copy(layername, layer[get(i)].name);</div><div class="line">	subtxt(namestart, get(layername), 0, 5);</div><div class="line">	if(namestart == 'skin_', removelayer(get(layername)); dec(i); );</div><div class="line">  );</div><div class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="动态热点"><a href="#动态热点" class="headerlink" title="动态热点"></a>动态热点</h3><p>在 <code>tour.xml</code> 空白处的scene标签的外面，添加动作代码</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"do_crop_animation"</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 为热点注册属性 --&gt;</span></div><div class="line">	registerattribute(xframes, calc((imagewidth / %1) BOR 0));</div><div class="line">	registerattribute(yframes, calc((imageheight / %2) BOR 0));</div><div class="line">	registerattribute(frames, calc(xframes * yframes));</div><div class="line">	registerattribute(frame, 0);</div><div class="line"> </div><div class="line">	set(crop, '0|0|%1|%2');</div><div class="line"> </div><div class="line">	setinterval(calc('crop_anim_' + name), calc(1.0 / %3),</div><div class="line">		if(loaded,</div><div class="line">			inc(frame);</div><div class="line">			if(frame GE frames, if(onlastframe !== null, onlastframe() ); set(frame,0); );</div><div class="line">			mod(xpos, frame, xframes);</div><div class="line">			div(ypos, frame, xframes);</div><div class="line">			Math.floor(ypos);</div><div class="line">			mul(xpos, %1);</div><div class="line">			mul(ypos, %2);</div><div class="line">			calc(crop, xpos + '|' + ypos + '|%1|%2');</div><div class="line">		  ,</div><div class="line">			clearinterval(calc('crop_anim_' + name));</div><div class="line">		  );</div><div class="line">	  );</div><div class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></div></pre></td></tr></table></figure>
<p>在 <code>hotspot</code> 或 <code>layer</code> 的代码添加代码， <code>do_crop_animation(每帧宽,每帧高,fps)</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">url="explosion.png"  onloaded="do_crop_animation(100,100, 60)"</div></pre></td></tr></table></figure>
<h3 id="动态热点添加始终显示的文字"><a href="#动态热点添加始终显示的文字" class="headerlink" title="动态热点添加始终显示的文字"></a>动态热点添加始终显示的文字</h3><p>显示 <code>&lt;scene&gt; title</code> 中的文字</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">hotspot</span> <span class="attr">name</span>=<span class="string">"spot1"</span> <span class="attr">url</span>=<span class="string">"animatedhotspot_white.png"</span> <span class="attr">onloaded</span>=<span class="string">"do_crop_animation(64,64, 60);"</span>   <span class="attr">ath</span>=<span class="string">"-15"</span> <span class="attr">atv</span>=<span class="string">"-12"</span> <span class="attr">onclick</span>=<span class="string">"loadscene(get(linkedscene))"</span> <span class="attr">linkedscene</span>=<span class="string">"scene_01"</span>/&gt;</span></div></pre></td></tr></table></figure>
<p>或者在 <code>&lt;hotpsot&gt; text</code> 中添加显示自定义的文字</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">hotspot</span> <span class="attr">name</span>=<span class="string">"spot1"</span> <span class="attr">url</span>=<span class="string">"animatedhotspot_white.png"</span> <span class="attr">onloaded</span>=<span class="string">"do_crop_animation(64,64, 60);"</span>   <span class="attr">ath</span>=<span class="string">"-15"</span> <span class="attr">atv</span>=<span class="string">"-12"</span> <span class="attr">onclick</span>=<span class="string">"loadscene(get(linkedscene))"</span> <span class="attr">text</span>=<span class="string">"自定义文字"</span>/&gt;</span></div></pre></td></tr></table></figure>
<p>在热点的 <code>onload</code> 事件中加上 <code>add_all_the_time_tooltip()</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">onloaded="do_crop_animation(64,64, 60);add_all_the_time_tooltip()"</div></pre></td></tr></table></figure>
<p>空白处加上 <code>action</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"add_all_the_time_tooltip"</span>&gt;</span></div><div class="line">	    txtadd(tooltipname, 'tooltip_', get(name));</div><div class="line">	    addplugin(get(tooltipname));</div><div class="line">	    txtadd(plugin[get(tooltipname)].parent, 'hotspot[', get(name), ']');</div><div class="line">	    set(plugin[get(tooltipname)].url,'%SWFPATH%/plugins/textfield.swf');</div><div class="line">	    set(plugin[get(tooltipname)].align,top);</div><div class="line">	    set(plugin[get(tooltipname)].edge,bottom);</div><div class="line">	    set(plugin[get(tooltipname)].x,0);</div><div class="line">	    set(plugin[get(tooltipname)].y,0);</div><div class="line">	    set(plugin[get(tooltipname)].autowidth,true);</div><div class="line">	    set(plugin[get(tooltipname)].autoheight,true);</div><div class="line">	    set(plugin[get(tooltipname)].vcenter,true);</div><div class="line">	    set(plugin[get(tooltipname)].background,true);</div><div class="line">	    set(plugin[get(tooltipname)].backgroundcolor,0x000000);</div><div class="line">	    set(plugin[get(tooltipname)].roundedge,5);</div><div class="line">	    set(plugin[get(tooltipname)].backgroundalpha,0.65);</div><div class="line">	    set(plugin[get(tooltipname)].padding,5);</div><div class="line">	    set(plugin[get(tooltipname)].border,false);</div><div class="line">	    set(plugin[get(tooltipname)].glow,0);</div><div class="line">	    set(plugin[get(tooltipname)].glowcolor,0xFFFFFF);</div><div class="line">	    set(plugin[get(tooltipname)].css,'text-align:center; color:#FFFFFF; font-family:MicrosoftYahei;  font-size:24px;');</div><div class="line">	    if(device.mobile,set(plugin[get(tooltipname)].css,'text-align:center; color:#FFFFFF; font-family:MicrosoftYahei; font-weight:bold; font-size:24px;');</div><div class="line">	    	);</div><div class="line">	    set(plugin[get(tooltipname)].textshadow,0);</div><div class="line">	    set(plugin[get(tooltipname)].textshadowrange,6.0);</div><div class="line">	    set(plugin[get(tooltipname)].textshadowangle,90);</div><div class="line">	    if(text == '' OR text === null,</div><div class="line">	    copy(plugin[get(tooltipname)].html,scene[get(linkedscene)].title),</div><div class="line">	    copy(plugin[get(tooltipname)].html,text)</div><div class="line">	    );    </div><div class="line">	    set(plugin[get(tooltipname)].enabled,false);	</div><div class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="热点和或图层在鼠标点击或鼠标悬停时进入动态模式"><a href="#热点和或图层在鼠标点击或鼠标悬停时进入动态模式" class="headerlink" title="热点和或图层在鼠标点击或鼠标悬停时进入动态模式"></a>热点和或图层在鼠标点击或鼠标悬停时进入动态模式</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"do_crop_animation_onclick"</span>&gt;</span>	</div><div class="line">		if(hotspot[get(name)].animated === null OR hotspot[get(name)].animated == false,</div><div class="line">		    set(hotspot[get(name)].animated,true);</div><div class="line">			setinterval(calc('crop_anim_' + name), calc(1.0 / %3),			</div><div class="line">					inc(frame);</div><div class="line">					if(frame GE frames, if(onlastframe !== null, onlastframe() ); set(frame,0); );</div><div class="line">					mod(xpos, frame, xframes);</div><div class="line">					div(ypos, frame, xframes);</div><div class="line">					Math.floor(ypos);</div><div class="line">					mul(xpos, %1);</div><div class="line">					mul(ypos, %2);</div><div class="line">					calc(crop, xpos + '|' + ypos + '|%1|%2');			  				</div><div class="line">			  );</div><div class="line">			  ,</div><div class="line">            set(hotspot[get(name)].animated,false);  </div><div class="line">			clearinterval(calc('crop_anim_' + name));</div><div class="line">			set(crop, '0|0|%1|%2');	</div><div class="line">		  );</div><div class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"> </div><div class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"do_crop_animation_register"</span>&gt;</span></div><div class="line">		registerattribute(xframes, calc((imagewidth / %1) BOR 0));</div><div class="line">		registerattribute(yframes, calc((imageheight / %2) BOR 0));</div><div class="line">		registerattribute(frames, calc(xframes * yframes));</div><div class="line">		registerattribute(frame, 0);</div><div class="line">		set(crop, '0|0|%1|%2');	</div><div class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"> </div><div class="line"> </div><div class="line"> </div><div class="line"><span class="comment">&lt;!-- example hotspots --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">hotspot</span> <span class="attr">name</span>=<span class="string">"spot1"</span> <span class="attr">url</span>=<span class="string">"animatedhotspot_white.png"</span> </span></div><div class="line">		<span class="attr">onover</span>=<span class="string">"do_crop_animation_onclick(64,64,60)"</span> <span class="attr">onout</span>=<span class="string">"do_crop_animation_onclick(64,64,60)"</span>   <span class="attr">ath</span>=<span class="string">"-15"</span> <span class="attr">atv</span>=<span class="string">"-12"</span> <span class="attr">onloaded</span>=<span class="string">"do_crop_animation_register(64,64)"</span> /&gt;</div><div class="line"> </div><div class="line"><span class="tag">&lt;<span class="name">hotspot</span> <span class="attr">name</span>=<span class="string">"spot1"</span> <span class="attr">url</span>=<span class="string">"animatedhotspot_white.png"</span> </span></div><div class="line">		<span class="attr">onclick</span>=<span class="string">"do_crop_animation_onclick(64,64,60)"</span>  <span class="attr">ath</span>=<span class="string">"-15"</span> <span class="attr">atv</span>=<span class="string">"-12"</span> <span class="attr">onloaded</span>=<span class="string">"do_crop_animation_register(64,64)"</span> /&gt;</div></pre></td></tr></table></figure>
<p>以上代码执行了一次动态循环后，序列图停留在第一帧，如果只是需要执行一次动态循环，并且序列图停留在最后一帧的话，那么 <code>do_crop_animation_onclick</code> 需更改（区别就是 <code>frame</code> 这个变量没有重置为 0 ，并且没有重新设置 <code>crop</code> ）</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"do_crop_animation_onclick"</span>&gt;</span> </div><div class="line">    if(hotspot[get(name)].animated === null OR hotspot[get(name)].animated == false,</div><div class="line">        set(hotspot[get(name)].animated,true);</div><div class="line">      setinterval(calc('crop_anim_' + name), calc(1.0 / %3),  </div><div class="line"> </div><div class="line">          inc(frame);</div><div class="line">          if(frame GE frames, if(onlastframe !== null, onlastframe() ); add(frame,frames,-1); );</div><div class="line">          mod(xpos, frame, xframes);</div><div class="line">          div(ypos, frame, xframes);</div><div class="line">          Math.floor(ypos);</div><div class="line">          mul(xpos, %1);</div><div class="line">          mul(ypos, %2);</div><div class="line">          calc(crop, xpos + '|' + ypos + '|%1|%2');               </div><div class="line">        );</div><div class="line">        ,</div><div class="line">        set(hotspot[get(name)].animated,false);  </div><div class="line">      clearinterval(calc('crop_anim_' + name));</div><div class="line">     </div><div class="line">      );</div><div class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="拖拽热点"><a href="#拖拽热点" class="headerlink" title="拖拽热点"></a>拖拽热点</h3><p>在 <code>&lt;hotspot/&gt;</code> 中添加代码</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ondown="draghotspot();"</div></pre></td></tr></table></figure>
<p>添加 action 代码</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"draghotspot"</span>&gt;</span></div><div class="line">	spheretoscreen(ath, atv, hotspotcenterx, hotspotcentery, 'l');</div><div class="line">	sub(drag_adjustx, mouse.stagex, hotspotcenterx);</div><div class="line">	sub(drag_adjusty, mouse.stagey, hotspotcentery);</div><div class="line">	asyncloop(pressed,</div><div class="line">		sub(dx, mouse.stagex, drag_adjustx);</div><div class="line">		sub(dy, mouse.stagey, drag_adjusty);</div><div class="line">		screentosphere(dx, dy, ath, atv);</div><div class="line">	  );</div><div class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="添加简单的全景视频"><a href="#添加简单的全景视频" class="headerlink" title="添加简单的全景视频"></a>添加简单的全景视频</h3><p>从 <code>viewer/examples/videopano</code> 中复制 <code>vtourskin.xml</code>，在主xml 添加代码</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">scene</span> <span class="attr">name</span>=<span class="string">"videopano"</span> <span class="attr">title</span>=<span class="string">"户外全景视频"</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- include the videoplayer interface / skin (with VR support) --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">include</span> <span class="attr">url</span>=<span class="string">"skin/videointerface.xml"</span> /&gt;</span></div><div class="line"></div><div class="line">	<span class="comment">&lt;!-- include the videoplayer plugin --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">plugin</span> <span class="attr">name</span>=<span class="string">"video"</span></span></div><div class="line">	        <span class="attr">url.html5</span>=<span class="string">"%SWFPATH%/plugins/videoplayer.js"</span></div><div class="line">	        <span class="attr">url.flash</span>=<span class="string">"%SWFPATH%/plugins/videoplayer.swf"</span></div><div class="line">	        <span class="attr">pausedonstart</span>=<span class="string">"true"</span></div><div class="line">	        <span class="attr">loop</span>=<span class="string">"true"</span></div><div class="line">	        <span class="attr">volume</span>=<span class="string">"1.0"</span></div><div class="line">	        <span class="attr">onloaded</span>=<span class="string">"add_video_sources();"</span></div><div class="line">	        /&gt;</div><div class="line"></div><div class="line">	<span class="comment">&lt;!-- use the videoplayer plugin as panoramic image source --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">image</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">sphere</span> <span class="attr">url</span>=<span class="string">"plugin:video"</span> /&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">image</span>&gt;</span></div><div class="line"></div><div class="line">	<span class="comment">&lt;!-- set the default view --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">view</span> <span class="attr">hlookat</span>=<span class="string">"0"</span> <span class="attr">vlookat</span>=<span class="string">"0"</span> <span class="attr">fovtype</span>=<span class="string">"DFOV"</span> <span class="attr">fov</span>=<span class="string">"130"</span> <span class="attr">fovmin</span>=<span class="string">"75"</span> <span class="attr">fovmax</span>=<span class="string">"150"</span> <span class="attr">distortion</span>=<span class="string">"0.0"</span> /&gt;</span></div><div class="line"></div><div class="line">	<span class="comment">&lt;!-- add the video sources and play the video --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"add_video_sources"</span>&gt;</span></div><div class="line">		videointerface_addsource('1024x512', '%CURRENTXML%/video/video-1024x512.mp4|%CURRENTXML%/video/video-1024x512.webm|%CURRENTXML%/video/iphone-audio.m4a', '%CURRENTXML%/video/video-1024x512-poster.jpg');</div><div class="line">		videointerface_addsource('1920x960', '%CURRENTXML%/video/video-1920x960.mp4|%CURRENTXML%/video/video-1920x960.webm|%CURRENTXML%/video/iphone-audio.m4a', '%CURRENTXML%/video/video-1920x960-poster.jpg');</div><div class="line">		</div><div class="line">		if(device.ios,</div><div class="line">			<span class="comment">&lt;!-- iOS Safari has a very slow 'video-to-webgl-texture' transfer, therefore use a low-res video by default --&gt;</span></div><div class="line">			videointerface_play('1024x512');</div><div class="line">		  ,</div><div class="line">			videointerface_play('1920x960');</div><div class="line">		  );</div><div class="line">	<span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">scene</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="添加雨雪特效"><a href="#添加雨雪特效" class="headerlink" title="添加雨雪特效"></a>添加雨雪特效</h3><ol>
<li><p>添加文件 <a href="http://pan.baidu.com/s/1gfLTx6N" target="_blank" rel="external">http://pan.baidu.com/s/1gfLTx6N</a> 密码：6shh  </p>
</li>
<li><p>在 <code>viewer\plugins</code> 拷贝 <code>snow.swf</code> 和 <code>snow.js</code>  </p>
</li>
<li><p>添加  <code>&lt;scene onstart=&quot;snowballs();&quot;&gt;</code>  </p>
<p> 目前可选的特效</p>
<ul>
<li>默认雪 <code>onstart=&#39;defaultsnow();&#39;</code></li>
<li>雪球 <code>onstart=&#39;snowball();&#39;</code></li>
<li>雪花 <code>onstart=&#39;snowflakes();&#39;</code></li>
<li>银色星星 <code>onstart=&#39;silverstars();&#39;</code></li>
<li>金色星星 <code>onstart=&#39;goldenstars();&#39;</code></li>
<li>心形 <code>onstart=&#39;hearts();&#39;</code></li>
<li>笑脸 <code>onstart=&#39;smileys();&#39;</code></li>
<li>钱 <code>onstart=&#39;money();&#39;</code></li>
<li>雨 <code>onstart=&#39;rain();&#39;</code></li>
<li>大雨 <code>onstart=&#39;heavyrain();&#39;</code></li>
</ul>
</li>
<li><p>在 <code>&lt;scene&gt;</code> 添加代码</p>
</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">include</span> <span class="attr">url</span>=<span class="string">"snow.xml"</span> /&gt;</span></div><div class="line">``` </div><div class="line"></div><div class="line">### 自动旋转</div><div class="line"></div><div class="line">添加代码</div><div class="line"></div><div class="line">```xml</div><div class="line"><span class="tag">&lt;<span class="name">autorotate</span> <span class="attr">enabled</span>=<span class="string">"true"</span></span></div><div class="line"><span class="attr">waittime</span>=<span class="string">"5.0"</span></div><div class="line"><span class="attr">speed</span>=<span class="string">"-3.0"</span></div><div class="line"><span class="attr">horizon</span>=<span class="string">"0.0"</span></div><div class="line"><span class="attr">tofov</span>=<span class="string">"120.0"</span></div><div class="line">/&gt;</div></pre></td></tr></table></figure>
<ul>
<li><code>waittime</code> 代表在最近一次用户交互行为之后要开始自动旋转之前的等待时间。以秒为单位。  </li>
<li><code>speed</code> 为旋转速度。当该数值为正值时向右旋转，为负值时向左旋转。</li>
<li><code>horizon</code> 为场景在自动旋转时将达到的水平位置。</li>
<li><code>tofov</code> 为旋转中要达到的视场角。</li>
</ul>
<h3 id="无按钮控制的自动旋转"><a href="#无按钮控制的自动旋转" class="headerlink" title="无按钮控制的自动旋转"></a>无按钮控制的自动旋转</h3><p>自动旋转场景，场景旋转一圈后自动进入下一个场景，最后一个场景浏览结束后，进入第一个场景。需添加如下代码：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">autorotate</span> <span class="attr">enabled</span>=<span class="string">"true"</span></span></div><div class="line"><span class="attr">waittime</span>=<span class="string">"5.0"</span></div><div class="line"><span class="attr">speed</span>=<span class="string">"-3.0"</span></div><div class="line"><span class="attr">horizon</span>=<span class="string">"0.0"</span></div><div class="line"><span class="attr">tofov</span>=<span class="string">"120.0"</span></div><div class="line">/&gt;</div></pre></td></tr></table></figure>
<p>修改 <code>&lt;action name=&quot;startup/&gt;</code> 中的代码</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"startup"</span>&gt;</span></div><div class="line">if(startscene === null, copy(startscene,scene[0].name));</div><div class="line">loadscene(get(startscene), null, MERGE);</div><div class="line">if(autorotate.enabled,bombtimer(0));</div><div class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></div></pre></td></tr></table></figure>
<p>在 <code>xml</code> 文件中加入下面的代码</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">events</span> <span class="attr">onmousedown</span>=<span class="string">"set(bt,0);"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"bombtimer"</span>&gt;</span></div><div class="line">set(autorotate.enabled,true);</div><div class="line">set(bt,%1);</div><div class="line">add(bt,1);</div><div class="line">delayedcall(1, bombtimer(get(bt)));</div><div class="line">copy(bt_1,autorotate.speed);</div><div class="line">Math.abs(bt_1);</div><div class="line">div(bt_2,360,bt_1);</div><div class="line">add(bt_2,autorotate.waittime);</div><div class="line">if(bt GE bt_2, set(bt,0); nextscene(););</div><div class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"nextscene"</span>&gt;</span></div><div class="line">set(ns, get(scene[get(xml.scene)].index));</div><div class="line">set(maxs, get(scene.count));</div><div class="line">add(ns,1);</div><div class="line">if(ns == maxs, set(ns,0));</div><div class="line">loadscene(get(scene[get(ns)].name), null, MERGE, BLEND(1.5));</div><div class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="按钮控制的自动旋转"><a href="#按钮控制的自动旋转" class="headerlink" title="按钮控制的自动旋转"></a>按钮控制的自动旋转</h3><p>添加代码</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">autorotate</span> <span class="attr">enabled</span>=<span class="string">"true"</span></span></div><div class="line"><span class="attr">waittime</span>=<span class="string">"5.0"</span></div><div class="line"><span class="attr">speed</span>=<span class="string">"-3.0"</span></div><div class="line"><span class="attr">horizon</span>=<span class="string">"0.0"</span></div><div class="line"><span class="attr">tofov</span>=<span class="string">"120.0"</span></div><div class="line">/&gt;</div></pre></td></tr></table></figure>
<p>在对应的按钮，通常为 <code>&lt;layer&gt;</code> 标签中找到 <code>onclick</code> 属性替换，如果没有则直接添加</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">layer</span> <span class="attr">...</span> <span class="attr">onclick</span>=<span class="string">"switch(autorotate.enabled);"</span> <span class="attr">...</span> /&gt;</span></div></pre></td></tr></table></figure>
<h3 id="添加陀螺仪"><a href="#添加陀螺仪" class="headerlink" title="添加陀螺仪"></a>添加陀螺仪</h3><p>加载插件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">plugin</span> <span class="attr">name</span>=<span class="string">"gyro"</span> <span class="attr">devices</span>=<span class="string">"html5"</span></span></div><div class="line">	        <span class="attr">url</span>=<span class="string">"%SWFPATH%/plugins/gyro2.js"</span></div><div class="line">	        <span class="attr">enabled</span>=<span class="string">"false"</span></div><div class="line">                <span class="attr">onavailable</span>=<span class="string">"gyro_available_info();"</span></div><div class="line">	        /&gt;</div><div class="line"> </div><div class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"gyro_available_info"</span>&gt;</span></div><div class="line">		set(layer[gyrobutton].visible, true);</div><div class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></div></pre></td></tr></table></figure>
<p>控制按钮</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"gyrobutton"</span> <span class="attr">url</span>=<span class="string">"gyroicon.png"</span> <span class="attr">scale</span>=<span class="string">"0.5"</span> <span class="attr">align</span>=<span class="string">"right"</span> <span class="attr">x</span>=<span class="string">"10"</span> <span class="attr">visible</span>=<span class="string">"false"</span> </span></div><div class="line">		       <span class="attr">onclick</span>=<span class="string">"switch(plugin[gyro].enabled);"</span></div><div class="line">		       /&gt;</div></pre></td></tr></table></figure>
<p>默认皮肤开启陀螺仪功能（在 <code>tour.xml</code> 的 <code>skin_settings</code>中设置）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gyro=&quot;true&quot;</div></pre></td></tr></table></figure>
<p>在 <code>tour.xml</code> 的 <code>include</code> 的下一行添加</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">plugin</span> <span class="attr">name</span>=<span class="string">"skin_gyro"</span> </span></div><div class="line">		<span class="attr">enabled</span>=<span class="string">"true"</span></div><div class="line">		<span class="attr">camroll</span>=<span class="string">"false"</span></div><div class="line">   		<span class="attr">onenable</span>=<span class="string">"set(view.limitview, range);"</span></div><div class="line">		/&gt;</div></pre></td></tr></table></figure>
<h3 id="场景过渡效果"><a href="#场景过渡效果" class="headerlink" title="场景过渡效果"></a>场景过渡效果</h3><p>修改全部过渡效果，只需修改 <code>&lt;skin_settings /&gt;</code>中以下代码</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">loadscene_blend="OPENBLEND(0.5, 0.0, 0.75, 0.05, linear)"</div><div class="line">loadscene_blend_prev="SLIDEBLEND(0.5, 180, 0.75, linear)"</div><div class="line">loadscene_blend_next="SLIDEBLEND(0.5,   0, 0.75, linear)"</div></pre></td></tr></table></figure>
<p>如果想为某个特殊的 <code>loadscene</code> 动作加上不一样的过渡效果，在主 <code>xml</code> 的 <code>scene</code> 外加入以下代码</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">blendmodes</span> <span class="attr">name</span>=<span class="string">"no blending"</span>       <span class="attr">description</span>=<span class="string">"无过渡效果"</span>  <span class="attr">blend</span>=<span class="string">"NOBLEND"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">blendmodes</span> <span class="attr">name</span>=<span class="string">"simple crossblending"</span> <span class="attr">description</span>=<span class="string">"简单淡入淡出"</span> <span class="attr">blend</span>=<span class="string">"BLEND(1.0, easeInCubic)"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">blendmodes</span> <span class="attr">name</span>=<span class="string">"zoom blend"</span>        <span class="attr">description</span>=<span class="string">"缩放过渡"</span>  <span class="attr">blend</span>=<span class="string">"ZOOMBLEND(2.0, 2.0, easeInOutSine)"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">blendmodes</span> <span class="attr">name</span>=<span class="string">"black-out"</span>         <span class="attr">description</span>=<span class="string">"黑场过渡"</span>  <span class="attr">blend</span>=<span class="string">"COLORBLEND(2.0, 0x000000, easeOutSine)"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">blendmodes</span> <span class="attr">name</span>=<span class="string">"white-flash"</span>       <span class="attr">description</span>=<span class="string">"白场过渡"</span>  <span class="attr">blend</span>=<span class="string">"LIGHTBLEND(1.0, 0xFFFFFF, 2.0, linear)"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">blendmodes</span> <span class="attr">name</span>=<span class="string">"right-to-left"</span>     <span class="attr">description</span>=<span class="string">"从右至左"</span>  <span class="attr">blend</span>=<span class="string">"SLIDEBLEND(1.0, 0.0, 0.2, linear)"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">blendmodes</span> <span class="attr">name</span>=<span class="string">"top-to-bottom"</span>     <span class="attr">description</span>=<span class="string">"从上至下"</span>   <span class="attr">blend</span>=<span class="string">"SLIDEBLEND(1.0, 90.0, 0.01, linear)"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">blendmodes</span> <span class="attr">name</span>=<span class="string">"diagonal"</span>          <span class="attr">description</span>=<span class="string">"对角线"</span>     <span class="attr">blend</span>=<span class="string">"SLIDEBLEND(1.0, 135.0, 0.4, linear)"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">blendmodes</span> <span class="attr">name</span>=<span class="string">"circle open"</span>       <span class="attr">description</span>=<span class="string">"圆形展开"</span>      <span class="attr">blend</span>=<span class="string">"OPENBLEND(1.0, 0.0, 0.2, 0.0, linear)"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">blendmodes</span> <span class="attr">name</span>=<span class="string">"vertical open"</span>     <span class="attr">description</span>=<span class="string">"垂直展开"</span>     <span class="attr">blend</span>=<span class="string">"OPENBLEND(0.7, 1.0, 0.1, 0.0, linear)"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">blendmodes</span> <span class="attr">name</span>=<span class="string">"horizontal open"</span>   <span class="attr">description</span>=<span class="string">"水平展开"</span>    <span class="attr">blend</span>=<span class="string">"OPENBLEND(1.0, -1.0, 0.3, 0.0, linear)"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">blendmodes</span> <span class="attr">name</span>=<span class="string">"elliptic + zoom"</span>   <span class="attr">description</span>=<span class="string">"椭圆缩放"</span>      <span class="attr">blend</span>=<span class="string">"OPENBLEND(1.0, -0.5, 0.3, 0.8, linear)"</span> /&gt;</span></div></pre></td></tr></table></figure>
<p>修改 <code>loadscene(scenename, null, MERGE, get(blendmodes[black-out].blend));</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">hotspot</span> <span class="attr">onclick</span>=<span class="string">"loadscene(scene_shuilifang, null, MERGE, get(blendmodes[vertical open].blend));"</span> /&gt;</span></div></pre></td></tr></table></figure>
<h3 id="隐藏显示热点"><a href="#隐藏显示热点" class="headerlink" title="隐藏显示热点"></a>隐藏显示热点</h3><p>添加 <code>&lt;action&gt;</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"hideBox"</span>&gt;</span></div><div class="line">  tween(%1.alpha,0,0.5);</div><div class="line">  wait(1);</div><div class="line">  set(%1.visible,false);</div><div class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"showBox"</span>&gt;</span></div><div class="line">  set(%1.alpha,0);</div><div class="line">  set(%1.visible,true);</div><div class="line">  tween(%1.alpha,1,0.5);</div><div class="line">  tween(%1.scale,1,0.5,easeOutBack);</div><div class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></div></pre></td></tr></table></figure>
<p>使用<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">hotspot</span> <span class="attr">name</span>=<span class="string">"spot1"</span> <span class="attr">style</span>=<span class="string">"skin_hotspotstyle"</span> <span class="attr">ath</span>=<span class="string">"46.131"</span> <span class="attr">atv</span>=<span class="string">"24.389"</span> <span class="attr">visible</span>=<span class="string">"true"</span> <span class="attr">onclick</span>=<span class="string">"spot1Click"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"spot1Click"</span>&gt;</span></div><div class="line">	hideBox(hotspot[spot1]);</div><div class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h3 id="获取全景视频进度"><a href="#获取全景视频进度" class="headerlink" title="获取全景视频进度"></a>获取全景视频进度</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 获取视频进度 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"get_video_time"</span>&gt;</span></div><div class="line">  setinterval(skin_video_seek_updates0, 0.1, skin_video_updatetime0())</div><div class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_video_updatetime0"</span>&gt;</span></div><div class="line">  setStop(4,video_pause_events(););</div><div class="line"><span class="tag">&lt;/<span class="name">action</span> &gt;</span></div><div class="line">		</div><div class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"setStop"</span>&gt;</span></div><div class="line">  copy(t1, plugin[video].time);</div><div class="line">  if(t1 GT %1,%2);</div><div class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"> </div><div class="line"><span class="comment">&lt;!-- 视频暂停回调 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"video_pause_events"</span>&gt;</span></div><div class="line">  plugin[video].pause();</div><div class="line">  clearinterval(skin_video_seek_updates0);</div><div class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></div></pre></td></tr></table></figure>
</div></header></article><section class="reward"> <a class="btn-reward" href="#">打赏</a><div class="reward-wrapper clearfix"><img src="/img/wechat.png" title="微信"></div></section><div class="comments" id="lv-container" data-id="city" data-uid="MTAyMC8zMDA5Mi82NjQ3"><script>(function(d, s) {var j, e = d.getElementsByTagName(s)[0];if (typeof LivereTower === 'function') { return; } j = d.createElement(s);j.src = 'https://cdn-city.livere.com/js/embed.dist.js';j.async = true;e.parentNode.insertBefore(j, e);})(document, 'script');</script></div></main><footer class="foot"><div class="foot-copy">&copy; 2017-2018 NingBo</div></footer><script src="/js/scroller.js"></script><script src="/js/main.js"></script></body></html>